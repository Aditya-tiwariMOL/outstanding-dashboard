<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Outstanding Receivables Dashboard</title>

<style>
:root{
  --brand:#0B419B;
  --border:#e4e8f0;
  --bg:#f5f7fb;
}

body{
  margin:0;
  padding:16px;
  font-family:Arial, sans-serif;
  background:var(--bg);
}

.container{
  background:#fff;
  border-radius:12px;
  padding:20px;
}

h1{color:var(--brand);margin:0}
.total{font-size:32px;font-weight:bold;margin:8px 0}
.updated{color:#666;margin-bottom:16px}

.table-wrap{overflow-x:auto}

table{
  border-collapse:collapse;
  min-width:900px;
  width:100%;
}

th,td{
  padding:12px;
  border-bottom:1px solid var(--border);
  text-align:right;
}

th:first-child,td:first-child{text-align:left}

thead{
  background:#eef3fb;
  color:var(--brand);
}

.sales{
  font-weight:bold;
  cursor:pointer;
  border-left:4px solid var(--brand);
}

.customer{
  background:#fafbff;
  cursor:pointer;
}

.invoice{
  font-style:italic;
  color:#555;
}

.toggle{margin-right:6px}
.red{color:#d93025}

@media(max-width:600px){
  body{padding:8px}
  h1{font-size:20px}
  .total{font-size:26px}
}
</style>
</head>

<body>
<div class="container">
  <h1>Outstanding Receivables Dashboard</h1>
  <div class="total">₹ 7,74,000</div>
  <div class="updated">Last updated: 21 Jan 2026</div>

  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th>Sales PIC</th>
          <th>Total</th>
          <th>90+</th>
          <th>61–90</th>
          <th>31–60</th>
          <th>1–30</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>
</div>

<script>
/* ================= DATA ================= */
const data = [
  {
    name:"Bharat San",
    total:"1,23,000",
    buckets:["–","78,000","–","45,000"],
    customers:[
      {
        name:"ABC Traders",
        total:"45,000",
        buckets:["–","–","–","45,000"],
        invoices:[{no:"INV-1001",total:"45,000"}]
      },
      {
        name:"XYZ Industries",
        total:"78,000",
        buckets:["–","78,000","–","–"],
        invoices:[]
      }
    ]
  },
  {
    name:"Amit Verma",
    total:"2,82,000",
    buckets:["1,25,000","–","1,02,000","55,000"],
    customers:[
      {
        name:"ABC Traders",
        total:"60,000",
        buckets:["–","–","60,000","–"],
        invoices:[{no:"INV-2001",total:"60,000"}]
      }
    ]
  },
  {
    name:"Neha Kapoor",
    total:"2,19,000",
    buckets:["90,000","91,000","–","38,000"],
    customers:[]
  }
];

/* ================= STATE ================= */
const tbody=document.getElementById("tbody");
let openSalesRow=null;
let openCustomerRow=null;

/* ================= HELPERS ================= */
function removeUntilNextSales(startRow){
  let row=startRow.nextSibling;
  while(row && !row.classList.contains("sales")){
    let next=row.nextSibling;
    row.remove();
    row=next;
  }
}

/* ================= RENDER ================= */
function render(){
  tbody.innerHTML="";
  data.forEach((s)=>{
    const tr=document.createElement("tr");
    tr.className="sales";
    tr.innerHTML=`
      <td><span class="toggle">▶</span>${s.name}</td>
      <td>${s.total}</td>
      <td class="red">${s.buckets[0]}</td>
      <td>${s.buckets[1]}</td>
      <td>${s.buckets[2]}</td>
      <td>${s.buckets[3]}</td>
    `;
    tr.onclick=()=>toggleSales(tr,s);
    tbody.appendChild(tr);
  });
}

/* ================= SALES ================= */
function toggleSales(row,sales){
  // Close ANY open Sales PIC fully
  if(openSalesRow){
    removeUntilNextSales(openSalesRow);
    openSalesRow=null;
    openCustomerRow=null;
  }

  // If clicking same row again → just close
  if(openSalesRow===row) return;

  openSalesRow=row;

  let insertAfter=row;
  sales.customers.forEach(c=>{
    const tr=document.createElement("tr");
    tr.className="customer";
    tr.innerHTML=`
      <td>&nbsp;&nbsp;<span class="toggle">▶</span>${c.name}</td>
      <td>${c.total}</td>
      <td>${c.buckets[0]}</td>
      <td>${c.buckets[1]}</td>
      <td>${c.buckets[2]}</td>
      <td>${c.buckets[3]}</td>
    `;
    tr.onclick=(e)=>{e.stopPropagation();toggleCustomer(tr,c)};
    insertAfter.after(tr);
    insertAfter=tr;
  });
}

/* ================= CUSTOMER ================= */
function toggleCustomer(row,customer){
  // Close previous customer invoices
  if(openCustomerRow){
    let r=openCustomerRow.nextSibling;
    while(r && r.classList.contains("invoice")){
      let n=r.nextSibling;
      r.remove();
      r=n;
    }
    if(openCustomerRow===row){
      openCustomerRow=null;
      return;
    }
  }

  openCustomerRow=row;

  let insertAfter=row;
  customer.invoices.forEach(inv=>{
    const tr=document.createElement("tr");
    tr.className="invoice";
    tr.innerHTML=`
      <td>&nbsp;&nbsp;&nbsp;&nbsp;${inv.no}</td>
      <td>${inv.total}</td>
      <td>–</td>
      <td>–</td>
      <td>–</td>
      <td>${inv.total}</td>
    `;
    insertAfter.after(tr);
    insertAfter=tr;
  });
}

/* ================= INIT ================= */
render();
</script>
</body>
</html>
